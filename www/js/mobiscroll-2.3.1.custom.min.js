(function(b){function N(a,g){function d(a){return b.isArray(c.readonly)?(a=b(".dwwl",m).index(a),c.readonly[a]):c.readonly}function i(b){var a="",c;for(c in R[b])a+='<li class="dw-v" data-val="'+c+'" style="height:'+x+"px;line-height:"+x+'px;"><div class="dw-i">'+R[b][c]+"</div></li>";return a}function l(){var b=document.body,a=document.documentElement;return Math.max(b.scrollHeight,b.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight)}function D(a){u=b("li.dw-v",a).eq(0).index();v=b("li.dw-v",
a).eq(-1).index();p=b("ul",m).index(a);j=x;E=h}function S(a){var b=c.headerText;return b?"function"==typeof b?b.call(J,a):b.replace(/\{value\}/i,a):""}function s(){h.temp=O&&(null!==h.val&&h.val!=t.val()||!t.val().length)||null===h.values?c.parseValue(t.val()||"",h):h.values.slice(0);h.setValue(!0)}function T(a,c,g,d){F("validate",[m,c]);b(".dww ul",m).each(function(g){var f=b(this),n=b('li[data-val="'+h.temp[g]+'"]',f),m=n.index(),da=g==c||void 0===c;if(!n.hasClass("dw-v")){for(var e=n,i=0,k=0;e.prev().length&&
!e.hasClass("dw-v");)e=e.prev(),i++;for(;n.next().length&&!n.hasClass("dw-v");)n=n.next(),k++;(k<i&&k&&2!==d||!i||!e.hasClass("dw-v")||1==d)&&n.hasClass("dw-v")?m+=k:(n=e,m-=i)}if(!n.hasClass("dw-sel")||da)h.temp[g]=n.attr("data-val"),b(".dw-sel",f).removeClass("dw-sel"),n.addClass("dw-sel"),h.scroll(f,g,m,a)});h.change(g)}function y(){function a(){b(".dwc",m).each(function(){i=b(this).outerWidth(!0);g+=i;h=i>h?i:h});i=g>d?h:g;i=b(".dwwr",m).width(i+1).outerWidth();j=n.outerHeight()}if("inline"!=
c.display){var g=0,h=0,d=b(window).width(),f=window.innerHeight,e=b(window).scrollTop(),n=b(".dw",m),i,k,w,j,D,p={},q,o=void 0===c.anchor?t:c.anchor,f=f||b(window).height();if("modal"==c.display)a(),w=(d-i)/2,k=e+(f-j)/2;else if("bubble"==c.display){a();var L=o.offset(),r=b(".dw-arr",m),s=b(".dw-arrw-i",m),K=n.outerWidth();D=o.outerWidth();w=L.left-(n.outerWidth(!0)-D)/2;w=w>d-K?d-(K+20):w;w=0<=w?w:20;k=L.top-(n.outerHeight()+3);k<e||L.top>e+f?(n.removeClass("dw-bubble-top").addClass("dw-bubble-bottom"),
k=L.top+o.outerHeight()+3,q=k+n.outerHeight(!0)>e+f||L.top>e+f):n.removeClass("dw-bubble-bottom").addClass("dw-bubble-top");k=k>=e?k:e;e=L.left+D/2-(w+(K-s.outerWidth())/2);e>s.outerWidth()&&(e=s.outerWidth());r.css({left:e})}else p.width="100%","top"==c.display?k=e:"bottom"==c.display&&(k=e+f-n.outerHeight(),k=0<=k?k:0);p.top=k;p.left=w;n.css(p);b(".dwo, .dw-persp",m).height(0).height(l());q&&b(window).scrollTop(k+n.outerHeight(!0)-f)}}function F(a,c){var e;c.push(h);b.each([U,g],function(b,g){g[a]&&
(e=g[a].apply(J,c))});return e}function N(a){var b=+a.data("pos")+1;f(a,b>v?u:b,1)}function ea(a){var b=+a.data("pos")-1;f(a,b<u?v:b,2)}var h=this,W=b.mobiscroll,J=a,t=b(J),X,$,c=z({},aa),U={},ba,x,G,m,R=[],P={},O=t.is("input"),Q=!1;h.enable=function(){c.disabled=!1;O&&t.prop("disabled",!1)};h.disable=function(){c.disabled=!0;O&&t.prop("disabled",!0)};h.scroll=function(a,b,c,g,e,h){function k(){clearInterval(P[b]);P[b]=void 0;a.data("pos",c).closest(".dwwl").removeClass("dwa")}var f=(ba-c)*x,d,h=
h||H;a.attr("style",(g?ca+"-transition:all "+g.toFixed(1)+"s ease-out;":"")+(fa?ca+"-transform:translate3d(0,"+f+"px,0);":"top:"+f+"px;"));P[b]&&k();g&&void 0!==e?(d=0,a.closest(".dwwl").addClass("dwa"),P[b]=setInterval(function(){d+=0.1;a.data("pos",Math.round((c-e)*Math.sin(d/g*(Math.PI/2))+e));d>=g&&(k(),h())},100),F("onAnimStart",[b,g])):(a.data("pos",c),h())};h.setValue=function(a,b,g,e){e||(h.values=h.temp.slice(0));Q&&a&&T(g);b&&(G=c.formatResult(h.temp),h.val=G,O&&t.val(G).trigger("change"))};
h.validate=function(a,b){T(0.2,a,!0,b)};h.change=function(a){G=c.formatResult(h.temp);"inline"==c.display?h.setValue(!1,a):b(".dwv",m).html(S(G));a&&F("onChange",[G])};h.hide=function(a){if(!1===F("onClose",[G]))return!1;b(".dwtd").prop("disabled",!1).removeClass("dwtd");t.blur();m&&("inline"!=c.display&&c.animate&&!a?(b(".dw",m).addClass("dw-"+c.animate+" dw-out"),setTimeout(function(){m.remove();m=null},350)):(m.remove(),m=null),Q=!1,b(window).unbind(".dw"))};h.changeWheel=function(a,g){if(m){var e=
0,h,d,k=a.length;for(h in c.wheels)for(d in c.wheels[h]){if(-1<b.inArray(e,a)&&(R[e]=c.wheels[h][d],b("ul",m).eq(e).html(i(e)),k--,!k)){y();T(g);return}e++}}};h.show=function(a){if(c.disabled||Q)return!1;"top"==c.display&&(c.animate="slidedown");"bottom"==c.display&&(c.animate="slideup");s();F("onBeforeShow",[m]);var g=0,l,j="",S="",Z="";c.animate&&!a&&(S='<div class="dw-persp">',Z="</div>",j="dw-"+c.animate+" dw-in");j='<div class="'+c.theme+" dw-"+c.display+'">'+("inline"==c.display?'<div class="dw dwbg dwi"><div class="dwwr">':
S+'<div class="dwo"></div><div class="dw dwbg '+j+'"><div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div><div class="dwwr">'+(c.headerText?'<div class="dwv"></div>':""));for(a=0;a<c.wheels.length;a++){j+='<div class="dwc'+("scroller"!=c.mode?" dwpm":" dwsc")+(c.showLabel?"":" dwhl")+'"><div class="dwwc dwrc"><table cellpadding="0" cellspacing="0"><tr>';for(l in c.wheels[a])R[g]=c.wheels[a][l],j+='<td><div class="dwwl dwrc dwwl'+g+'">'+("scroller"!=c.mode?'<div class="dwwb dwwbp" style="height:'+
x+"px;line-height:"+x+'px;"><span>+</span></div><div class="dwwb dwwbm" style="height:'+x+"px;line-height:"+x+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+l+'</div><div class="dww dwrc" style="height:'+c.rows*x+"px;min-width:"+c.width+'px;"><ul>',j+=i(g),j+='</ul><div class="dwwo"></div></div><div class="dwwol"></div></div></td>',g++;j+="</tr></table></div></div>"}j+=("inline"!=c.display?'<div class="dwbc'+(c.button3?" dwbc-p":"")+'"><span class="dwbw dwb-s"><span class="dwb">'+c.setText+
"</span></span>"+(c.button3?'<span class="dwbw dwb-n"><span class="dwb">'+c.button3Text+"</span></span>":"")+'<span class="dwbw dwb-c"><span class="dwb">'+c.cancelText+"</span></span></div>"+Z:'<div class="dwcc"></div>')+"</div></div></div>";m=b(j);T();"inline"!=c.display?m.appendTo("body"):t.is("div")?t.html(m):m.insertAfter(t);Q=!0;"inline"!=c.display&&(b(".dwb-s span",m).click(function(){if(h.hide()!==false){h.setValue(false,true);F("onSelect",[h.val])}return false}),b(".dwb-c span",m).click(function(){h.hide()!==
false&&F("onCancel",[h.val]);return false}),c.button3&&b(".dwb-n span",m).click(c.button3),c.scrollLock&&m.bind("touchmove",function(a){a.preventDefault()}),b("input,select").each(function(){b(this).prop("disabled")||b(this).addClass("dwtd")}),b("input,select").prop("disabled",!0),y(),b(window).bind("resize.dw",y));m.delegate(".dwwl","DOMMouseScroll mousewheel",function(a){if(!d(this)){a.preventDefault();var a=a.originalEvent,a=a.wheelDelta?a.wheelDelta/120:a.detail?-a.detail/3:0,g=b("ul",this),c=
+g.data("pos"),c=Math.round(c-a);D(g);f(g,c,a<0?1:2)}}).delegate(".dwb, .dwwb",Y,function(){b(this).addClass("dwb-a")}).delegate(".dwwb",Y,function(a){var g=b(this).closest(".dwwl");if(!d(g)&&!g.hasClass("dwa")){a.preventDefault();a.stopPropagation();var e=g.find("ul"),h=b(this).hasClass("dwwbp")?N:ea;A=true;D(e);clearInterval(q);q=setInterval(function(){h(e)},c.delay);h(e)}}).delegate(".dwwl",Y,function(a){a.preventDefault();if(!I&&!d(this)&&!A&&c.mode!="clickpick"){I=true;o=b("ul",this);o.closest(".dwwl").addClass("dwa");
k=+o.data("pos");D(o);K=P[p]!==void 0;B=C(a);e=new Date;r=B;h.scroll(o,p,k)}});F("onShow",[m,G]);X.init(m,h)};h.init=function(a){X=z({defaults:{},init:H},W.themes[a.theme||c.theme]);$=W.i18n[a.lang||c.lang];z(g,a);z(c,X.defaults,$,g);h.settings=c;t.unbind(".dw");if(a=W.presets[c.preset])U=a.call(J,h),z(c,U,g),z(V,U.methods);ba=Math.floor(c.rows/2);x=c.height;void 0!==t.data("dwro")&&(J.readOnly=M(t.data("dwro")));Q&&h.hide();"inline"==c.display?h.show():(s(),O&&c.showOnFocus&&(t.data("dwro",J.readOnly),
J.readOnly=!0,t.bind("focus.dw",function(){h.show()})))};h.values=null;h.val=null;h.temp=null;h.init(g)}function l(a){for(var b in a)if(void 0!==D[a[b]])return!0;return!1}function C(a){var b=a.originalEvent,e=a.changedTouches;return e||b&&b.changedTouches?b?b.changedTouches[0].pageY:e[0].pageY:a.pageY}function M(a){return!0===a||"true"==a}function s(a,b,e){a=a>e?e:a;return a<b?b:a}function f(a,g,e,d,k){var g=s(g,u,v),f=b("li",a).eq(g),i=p,d=d?g==k?0.1:Math.abs(0.1*(g-k)):0;E.scroll(a,i,g,d,k,function(){E.temp[i]=
f.attr("data-val");E.validate(i,e)})}function i(a,b,e){return V[b]?V[b].apply(a,Array.prototype.slice.call(e,1)):"object"===typeof b?V.init.call(a,b):a}var d={},q,H=function(){},j,u,v,E,y=(new Date).getTime(),I,A,o,p,B,r,e,k,K,D=document.createElement("modernizr").style,fa=l(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),ca=function(){var a=["Webkit","Moz","O","ms"],b;for(b in a)if(l([a[b]+"Transform"]))return"-"+a[b].toLowerCase();return""}(),z=b.extend,
Y="touchstart mousedown",aa={width:70,height:40,rows:3,delay:300,disabled:!1,readonly:!1,showOnFocus:!0,showLabel:!0,wheels:[],theme:"",headerText:"{value}",display:"modal",mode:"scroller",preset:"",lang:"en-US",setText:"Set",cancelText:"Cancel",scrollLock:!0,formatResult:function(a){return a.join(" ")},parseValue:function(a,b){var e=b.settings.wheels,d=a.split(" "),k=[],f=0,i,j,l;for(i=0;i<e.length;i++)for(j in e[i]){if(void 0!==e[i][j][d[f]])k.push(d[f]);else for(l in e[i][j]){k.push(l);break}f++}return k}},
V={init:function(a){void 0===a&&(a={});return this.each(function(){this.id||(y+=1,this.id="scoller"+y);d[this.id]=new N(this,a)})},enable:function(){return this.each(function(){var a=d[this.id];a&&a.enable()})},disable:function(){return this.each(function(){var a=d[this.id];a&&a.disable()})},isDisabled:function(){var a=d[this[0].id];if(a)return a.settings.disabled},option:function(a,b){return this.each(function(){var e=d[this.id];if(e){var k={};"object"===typeof a?k=a:k[a]=b;e.init(k)}})},setValue:function(a,
b,e,k){return this.each(function(){var f=d[this.id];f&&(f.temp=a,f.setValue(!0,b,e,k))})},getInst:function(){return d[this[0].id]},getValue:function(){var a=d[this[0].id];if(a)return a.values},show:function(){var a=d[this[0].id];if(a)return a.show()},hide:function(){return this.each(function(){var a=d[this.id];a&&a.hide()})},destroy:function(){return this.each(function(){var a=d[this.id];a&&(a.hide(),b(this).unbind(".dw"),delete d[this.id],b(this).is("input")&&(this.readOnly=M(b(this).data("dwro"))))})}};
b(document).bind("touchmove mousemove",function(a){I&&(a.preventDefault(),r=C(a),E.scroll(o,p,s(k+(B-r)/j,u-1,v+1)),K=!0)});b(document).bind("touchend mouseup",function(a){if(I){a.preventDefault();var g=new Date-e,a=s(k+(B-r)/j,u-1,v+1),d;d=o.offset().top;300>g?(g=(r-B)/g,g=g*g/0.0012,0>r-B&&(g=-g)):g=r-B;if(!g&&!K){d=Math.floor((r-d)/j);var i=b("li",o).eq(d);i.addClass("dw-hl");setTimeout(function(){i.removeClass("dw-hl")},200)}else d=Math.round(k-g/j);f(o,d,0,!0,Math.round(a));I=!1;o=null}A&&(clearInterval(q),
A=!1);b(".dwb-a").removeClass("dwb-a")});b.fn.mobiscroll=function(a){z(this,b.mobiscroll.shorts);return i(this,a,arguments)};b.mobiscroll=b.mobiscroll||{setDefaults:function(a){z(aa,a)},presetShort:function(a){this.shorts[a]=function(b){return i(this,z(b,{preset:a}),arguments)}},shorts:{},presets:{},themes:{},i18n:{}};b.scroller=b.scroller||b.mobiscroll;b.fn.scroller=b.fn.scroller||b.fn.mobiscroll})(jQuery);(function(b){var N={inputClass:"",invalid:[],rtl:!1,group:!1,groupLabel:"Groups"};b.mobiscroll.presetShort("select");b.mobiscroll.presets.select=function(l){function C(b){return b?b.replace(/_/,""):""}function M(){var e,d=0,j={},l=[{}];f.group?(f.rtl&&(d=1),b("optgroup",i).each(function(e){j["_"+e]=b(this).attr("label")}),l[d]={},l[d][f.groupLabel]=j,e=q,d+=f.rtl?-1:1):e=i;l[d]={};l[d][y]={};b("option",e).each(function(){var e=b(this).attr("value");l[d][y]["_"+e]=b(this).text();b(this).prop("disabled")&&
I.push(e)});return l}var s=l.settings,f=b.extend({},N,s),i=b(this),d=i.val(),q=i.find('option[value="'+i.val()+'"]').parent(),H=q.index()+"",j=H,u,v=this.id+"_dummy";b('label[for="'+this.id+'"]').attr("for",v);var E=b('label[for="'+v+'"]'),y=void 0!==f.label?f.label:E.length?E.text():i.attr("name"),I=[],A={},o,p,B=s.readonly;f.group&&!b("optgroup",i).length&&(f.group=!1);f.invalid.length||(f.invalid=I);f.group?f.rtl?(o=1,p=0):(o=0,p=1):(o=-1,p=0);b("#"+v).remove();b("option",i).each(function(){A[b(this).attr("value")]=
b(this).text()});var r=b('<input type="text" id="'+v+'" value="'+A[i.val()]+'" class="'+f.inputClass+'" readonly />').insertBefore(i);f.showOnFocus&&r.focus(function(){l.show()});i.bind("change",function(){!u&&d!=i.val()&&l.setSelectVal([i.val()],true);u=false}).hide().closest(".ui-field-contain").trigger("create");l.setSelectVal=function(b,k,o){d=b[0];if(f.group){q=i.find('option[value="'+d+'"]').parent();j=q.index();l.temp=f.rtl?["_"+d,"_"+q.index()]:["_"+q.index(),"_"+d];if(j!==H){s.wheels=M();
l.changeWheel([p]);H=j+""}}else l.temp=["_"+d];l.setValue(true,k,o);if(k){r.val(A[d]);b=d!==i.val();i.val(d);b&&i.trigger("change")}};l.getSelectVal=function(b){return C((b?l.temp:l.values)[p])};return{width:50,wheels:void 0,headerText:!1,anchor:r,formatResult:function(b){return A[C(b[p])]},parseValue:function(){d=i.val();q=i.find('option[value="'+d+'"]').parent();j=q.index();return f.group&&f.rtl?["_"+d,"_"+j]:f.group?["_"+j,"_"+d]:["_"+d]},validate:function(e,k){if(k===o){j=C(l.temp[o]);if(j!==
H){q=i.find("optgroup").eq(j);j=q.index();d=(d=q.find("option").eq(0).val())||i.val();s.wheels=M();if(f.group){l.temp=f.rtl?["_"+d,"_"+j]:["_"+j,"_"+d];l.changeWheel([p]);H=j+""}}s.readonly=B}else d=C(l.temp[p]);var r=b("ul",e).eq(p);b.each(f.invalid,function(e,d){b('li[data-val="_'+d+'"]',r).removeClass("dw-v")})},onAnimStart:function(b){if(b===o)s.readonly=[f.rtl,!f.rtl]},onBeforeShow:function(){s.wheels=M();if(f.group)l.temp=f.rtl?["_"+d,"_"+q.index()]:["_"+q.index(),"_"+d]},onSelect:function(b){r.val(b);
u=true;i.val(C(l.values[p])).trigger("change");if(f.group)l.values=null},onCancel:function(){if(f.group)l.values=null},onChange:function(b){if(f.display=="inline"){r.val(b);u=true;i.val(C(l.temp[p])).trigger("change")}},onClose:function(){r.blur()},methods:{setValue:function(d,f,i){return this.each(function(){var j=b(this).mobiscroll("getInst");if(j)if(j.setSelectVal)j.setSelectVal(d,f,i);else{j.temp=d;j.setValue(true,f,i)}})},getValue:function(d){var f=b(this).mobiscroll("getInst");if(f)return f.getSelectVal?
f.getSelectVal(d):f.values}}}}})(jQuery);
